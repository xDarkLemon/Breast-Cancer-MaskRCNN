keras 
File
Edit
View
Insert
Cell
Kernel
Navigate
Widgets
Help

1  Pathology training with Mask R-CNN
1.1  Train with malignant and benign class instead of a single mass class
1
import os
2
import sys
3
import itertools
4
import math
5
import logging
6
import json
7
import re
8
import random
9
import time
10
import concurrent.futures
11
import numpy as np
12
import matplotlib
13
import matplotlib.pyplot as plt
14
import matplotlib.patches as patches
15
import matplotlib.lines as lines
16
from matplotlib.patches import Polygon
17
import imgaug
18
from imgaug import augmenters as iaa
19
?
20
# Root directory of the project 
21
# must add to system path before import mrcnn
22
ROOT_DIR = os.path.abspath("../")
23
print(ROOT_DIR)
24
sys.path.append(ROOT_DIR)
25
?
26
from mrcnn import utils
27
from mrcnn import visualize
28
from mrcnn.visualize import display_images
29
from mrcnn import model as modellib
30
from mrcnn.model import log
31
?
32
import mammo_baseline_pathology
33
?
34
%matplotlib inline 
35
?
36
?
/home/liujing/liuyibo/Mammo_MaskRCNN
Using TensorFlow backend.
1
# Comment out to reload imported modules if they change
2
%load_ext autoreload
3
%autoreload 2
1.2  Configurations
1
# Dataset directory
2
DATASET_DIR = os.path.join(ROOT_DIR, "dataset/mammo_all")
3
?
4
# Load dataset
5
subset = "mass_train"
6
if "3x" in subset:
7
    augmented=True
8
else:
9
    augmented=False
10
?
11
dataset_train = mammo_baseline_pathology.MammoDataset()
12
dataset_train.load_mammo(DATASET_DIR, subset=subset, augmented=augmented, json_filename="mammo_all_ddsm_mass_train.json")
13
?
14
# Must call before using the dataset
15
dataset_train.prepare()
16
?
17
print("Image Count: {}".format(len(dataset_train.image_ids)))
18
print("Class Count: {}".format(dataset_train.num_classes))
19
for i, info in enumerate(dataset_train.class_info):
20
    print("{:3}. {:50}".format(i, info['name']))
21
?
22
# Load validation dataset
23
dataset_val = mammo_baseline_pathology.MammoDataset() # May17
24
dataset_val.load_mammo(DATASET_DIR, "mass_val", augmented=augmented, json_filename="mammo_all_ddsm_mass_train.json")
25
dataset_val.prepare()
26
?
27
print("Images: {}\nClasses: {}".format(len(dataset_val.image_ids), dataset_val.class_names))
mass_train
Image Count: 985
Class Count: 3
  0. BG                                                
  1. MALIGNANT                                         
  2. BENIGN                                            
mass_val
Images: 246
Classes: ['BG', 'MALIGNANT', 'BENIGN']
1.3  Notebook Preferences
1
def get_ax(rows=1, cols=1, size=16):
2
    """Return a Matplotlib Axes array to be used in
3
    all visualizations in the notebook. Provide a
4
    central point to control graph sizes.
5
    
6
    Adjust the size attribute to control how big to render images
7
    """
8
    _, ax = plt.subplots(rows, cols, figsize=(size*cols, size*rows))
9
    return ax
1
#######################################
2
#   Training with Pathology labelling #
3
#      images. Max_dim = 1024         # 
4
#      Training set size = 4x         # 
5
#######################################
6
?
7
# Configurations
8
# Use configuation from mammo.py, but override
9
# image resizing so we see the real sizes here
10
class NoResizeConfig(mammo_baseline_pathology.MammoConfig):
11
    BACKBONE = "resnet101"
12
#     IMAGE_RESIZE_MODE = "none"
13
#     USE_MINI_MASK = False
14
    # Adjust depending on your GPU memory
15
    IMAGES_PER_GPU = 1 
16
    
17
    IMAGE_MAX_DIM = 1024
18
?
19
    # Number of classes (including background)
20
    NUM_CLASSES = 1 + 2  # Background + Malignant + Benign
21
?
22
    # Number of training and validation steps per epoch
23
    STEPS_PER_EPOCH = (len(dataset_train.image_ids)) // IMAGES_PER_GPU
24
    VALIDATION_STEPS = max(1, len(dataset_val.image_ids) // IMAGES_PER_GPU)
25
    
26
    MINI_MASK_SHAPE = (56, 56)  # (height, width) of the mini-mask
27
    RPN_ANCHOR_SCALES = (32, 64, 128, 256, 512)
28
    RPN_TRAIN_ANCHORS_PER_IMAGE = 512
29
    RPN_ANCHOR_RATIOS = [0.5, 1, 2]
30
    
31
    # ROIs kept after non-maximum supression (training and inference)
32
    POST_NMS_ROIS_TRAINING = 2000 # Is it the number of ROIs?
33
    POST_NMS_ROIS_INFERENCE = 1000
34
    
35
    # Non-max suppression threshold to filter RPN proposals.
36
    # You can increase this during training to generate more propsals.
37
    RPN_NMS_THRESHOLD = 0.7
38
    
39
config = NoResizeConfig()
40
config.display()
41
?

Configurations:
BACKBONE                       resnet101
BACKBONE_STRIDES               [4, 8, 16, 32, 64]
BATCH_SIZE                     1
BBOX_STD_DEV                   [0.1 0.1 0.2 0.2]
COMPUTE_BACKBONE_SHAPE         None
DETECTION_MAX_INSTANCES        100
DETECTION_MIN_CONFIDENCE       0.7
DETECTION_NMS_THRESHOLD        0.3
FPN_CLASSIF_FC_LAYERS_SIZE     1024
GPU_COUNT                      1
GRADIENT_CLIP_NORM             5.0
IMAGES_PER_GPU                 1
IMAGE_MAX_DIM                  1024
IMAGE_META_SIZE                15
IMAGE_MIN_DIM                  512
IMAGE_MIN_SCALE                0
IMAGE_RESIZE_MODE              square
IMAGE_SHAPE                    [1024 1024    3]
LEARNING_MOMENTUM              0.9
LEARNING_RATE                  0.001
LOSS_WEIGHTS                   {'rpn_class_loss': 1.0, 'rpn_bbox_loss': 1.0, 'mrcnn_class_loss': 1.0, 'mrcnn_bbox_loss': 1.0, 'mrcnn_mask_loss': 1.0}
MASK_POOL_SIZE                 14
MASK_SHAPE                     [28, 28]
MAX_GT_INSTANCES               100
MEAN_PIXEL                     [54.78 54.78 54.78]
MINI_MASK_SHAPE                (56, 56)
NAME                           mammo_pathology
NUM_CLASSES                    3
POOL_SIZE                      7
POST_NMS_ROIS_INFERENCE        1000
POST_NMS_ROIS_TRAINING         2000
ROI_POSITIVE_RATIO             0.33
RPN_ANCHOR_RATIOS              [0.5, 1, 2]
RPN_ANCHOR_SCALES              (32, 64, 128, 256, 512)
RPN_ANCHOR_STRIDE              1
RPN_BBOX_STD_DEV               [0.1 0.1 0.2 0.2]
RPN_NMS_THRESHOLD              0.7
RPN_TRAIN_ANCHORS_PER_IMAGE    512
STEPS_PER_EPOCH                985
TOP_DOWN_PYRAMID_SIZE          256
TRAIN_BN                       False
TRAIN_ROIS_PER_IMAGE           200
USE_MINI_MASK                  True
USE_RPN_ROIS                   True
VALIDATION_STEPS               246
WEIGHT_DECAY                   0.0001


80
1
# save model path
2
MODEL_DIR = 'checkpoints'
3
?
4
# Create model
5
model = modellib.MaskRCNN(mode="training", config=config,                          
6
                          model_dir=MODEL_DIR)
7
?
8
# load weights
9
weights_path = 'resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5'
10
print("Loading weights:", weights_path)
11
model.load_weights(weights_path, by_name=True)
12
print("Weights loaded.")
13
?
14
# train
15
model.train(dataset_train, dataset_val, config.LEARNING_RATE, epochs=80, layers='all')
16
?
Loading weights: resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5
Weights loaded.

Starting at epoch 0. LR=0.001

Checkpoint Path: checkpoints/mammo_pathology20190520T0003/mask_rcnn_mammo_pathology_{epoch:04d}.h5
Selecting layers to train
conv1                  (Conv2D)
bn_conv1               (BatchNorm)
res2a_branch2a         (Conv2D)
bn2a_branch2a          (BatchNorm)
res2a_branch2b         (Conv2D)
bn2a_branch2b          (BatchNorm)
res2a_branch2c         (Conv2D)
res2a_branch1          (Conv2D)
bn2a_branch2c          (BatchNorm)
bn2a_branch1           (BatchNorm)
res2b_branch2a         (Conv2D)
bn2b_branch2a          (BatchNorm)
res2b_branch2b         (Conv2D)
bn2b_branch2b          (BatchNorm)
res2b_branch2c         (Conv2D)
bn2b_branch2c          (BatchNorm)
res2c_branch2a         (Conv2D)
bn2c_branch2a          (BatchNorm)
res2c_branch2b         (Conv2D)
bn2c_branch2b          (BatchNorm)
res2c_branch2c         (Conv2D)
bn2c_branch2c          (BatchNorm)
res3a_branch2a         (Conv2D)
bn3a_branch2a          (BatchNorm)
res3a_branch2b         (Conv2D)
bn3a_branch2b          (BatchNorm)
res3a_branch2c         (Conv2D)
res3a_branch1          (Conv2D)
bn3a_branch2c          (BatchNorm)
bn3a_branch1           (BatchNorm)
res3b_branch2a         (Conv2D)
bn3b_branch2a          (BatchNorm)
res3b_branch2b         (Conv2D)
bn3b_branch2b          (BatchNorm)
res3b_branch2c         (Conv2D)
bn3b_branch2c          (BatchNorm)
res3c_branch2a         (Conv2D)
bn3c_branch2a          (BatchNorm)
res3c_branch2b         (Conv2D)
bn3c_branch2b          (BatchNorm)
res3c_branch2c         (Conv2D)
bn3c_branch2c          (BatchNorm)
res3d_branch2a         (Conv2D)
bn3d_branch2a          (BatchNorm)
res3d_branch2b         (Conv2D)
bn3d_branch2b          (BatchNorm)
res3d_branch2c         (Conv2D)
bn3d_branch2c          (BatchNorm)
res4a_branch2a         (Conv2D)
bn4a_branch2a          (BatchNorm)
res4a_branch2b         (Conv2D)
bn4a_branch2b          (BatchNorm)
res4a_branch2c         (Conv2D)
res4a_branch1          (Conv2D)
bn4a_branch2c          (BatchNorm)
bn4a_branch1           (BatchNorm)
res4b_branch2a         (Conv2D)
bn4b_branch2a          (BatchNorm)
res4b_branch2b         (Conv2D)
bn4b_branch2b          (BatchNorm)
res4b_branch2c         (Conv2D)
bn4b_branch2c          (BatchNorm)
res4c_branch2a         (Conv2D)
bn4c_branch2a          (BatchNorm)
res4c_branch2b         (Conv2D)
bn4c_branch2b          (BatchNorm)
res4c_branch2c         (Conv2D)
bn4c_branch2c          (BatchNorm)
res4d_branch2a         (Conv2D)
bn4d_branch2a          (BatchNorm)
res4d_branch2b         (Conv2D)
bn4d_branch2b          (BatchNorm)
res4d_branch2c         (Conv2D)
bn4d_branch2c          (BatchNorm)
res4e_branch2a         (Conv2D)
bn4e_branch2a          (BatchNorm)
res4e_branch2b         (Conv2D)
bn4e_branch2b          (BatchNorm)
res4e_branch2c         (Conv2D)
bn4e_branch2c          (BatchNorm)
res4f_branch2a         (Conv2D)
bn4f_branch2a          (BatchNorm)
res4f_branch2b         (Conv2D)
bn4f_branch2b          (BatchNorm)
res4f_branch2c         (Conv2D)
bn4f_branch2c          (BatchNorm)
res4g_branch2a         (Conv2D)
bn4g_branch2a          (BatchNorm)
res4g_branch2b         (Conv2D)
bn4g_branch2b          (BatchNorm)
res4g_branch2c         (Conv2D)
bn4g_branch2c          (BatchNorm)
res4h_branch2a         (Conv2D)
bn4h_branch2a          (BatchNorm)
res4h_branch2b         (Conv2D)
bn4h_branch2b          (BatchNorm)
res4h_branch2c         (Conv2D)
bn4h_branch2c          (BatchNorm)
res4i_branch2a         (Conv2D)
bn4i_branch2a          (BatchNorm)
res4i_branch2b         (Conv2D)
bn4i_branch2b          (BatchNorm)
res4i_branch2c         (Conv2D)
bn4i_branch2c          (BatchNorm)
res4j_branch2a         (Conv2D)
bn4j_branch2a          (BatchNorm)
res4j_branch2b         (Conv2D)
bn4j_branch2b          (BatchNorm)
res4j_branch2c         (Conv2D)
bn4j_branch2c          (BatchNorm)
res4k_branch2a         (Conv2D)
bn4k_branch2a          (BatchNorm)
res4k_branch2b         (Conv2D)
bn4k_branch2b          (BatchNorm)
res4k_branch2c         (Conv2D)
bn4k_branch2c          (BatchNorm)
res4l_branch2a         (Conv2D)
bn4l_branch2a          (BatchNorm)
res4l_branch2b         (Conv2D)
bn4l_branch2b          (BatchNorm)
res4l_branch2c         (Conv2D)
bn4l_branch2c          (BatchNorm)
res4m_branch2a         (Conv2D)
bn4m_branch2a          (BatchNorm)
res4m_branch2b         (Conv2D)
bn4m_branch2b          (BatchNorm)
res4m_branch2c         (Conv2D)
bn4m_branch2c          (BatchNorm)
res4n_branch2a         (Conv2D)
bn4n_branch2a          (BatchNorm)
res4n_branch2b         (Conv2D)
bn4n_branch2b          (BatchNorm)
res4n_branch2c         (Conv2D)
bn4n_branch2c          (BatchNorm)
res4o_branch2a         (Conv2D)
bn4o_branch2a          (BatchNorm)
res4o_branch2b         (Conv2D)
bn4o_branch2b          (BatchNorm)
res4o_branch2c         (Conv2D)
bn4o_branch2c          (BatchNorm)
res4p_branch2a         (Conv2D)
bn4p_branch2a          (BatchNorm)
res4p_branch2b         (Conv2D)
bn4p_branch2b          (BatchNorm)
res4p_branch2c         (Conv2D)
bn4p_branch2c          (BatchNorm)
res4q_branch2a         (Conv2D)
bn4q_branch2a          (BatchNorm)
res4q_branch2b         (Conv2D)
bn4q_branch2b          (BatchNorm)
res4q_branch2c         (Conv2D)
bn4q_branch2c          (BatchNorm)
res4r_branch2a         (Conv2D)
bn4r_branch2a          (BatchNorm)
res4r_branch2b         (Conv2D)
bn4r_branch2b          (BatchNorm)
res4r_branch2c         (Conv2D)
bn4r_branch2c          (BatchNorm)
res4s_branch2a         (Conv2D)
bn4s_branch2a          (BatchNorm)
res4s_branch2b         (Conv2D)
bn4s_branch2b          (BatchNorm)
res4s_branch2c         (Conv2D)
bn4s_branch2c          (BatchNorm)
res4t_branch2a         (Conv2D)
bn4t_branch2a          (BatchNorm)
res4t_branch2b         (Conv2D)
bn4t_branch2b          (BatchNorm)
res4t_branch2c         (Conv2D)
bn4t_branch2c          (BatchNorm)
res4u_branch2a         (Conv2D)
bn4u_branch2a          (BatchNorm)
res4u_branch2b         (Conv2D)
bn4u_branch2b          (BatchNorm)
res4u_branch2c         (Conv2D)
bn4u_branch2c          (BatchNorm)
res4v_branch2a         (Conv2D)
bn4v_branch2a          (BatchNorm)
res4v_branch2b         (Conv2D)
bn4v_branch2b          (BatchNorm)
res4v_branch2c         (Conv2D)
bn4v_branch2c          (BatchNorm)
res4w_branch2a         (Conv2D)
bn4w_branch2a          (BatchNorm)
res4w_branch2b         (Conv2D)
bn4w_branch2b          (BatchNorm)
res4w_branch2c         (Conv2D)
bn4w_branch2c          (BatchNorm)
res5a_branch2a         (Conv2D)
bn5a_branch2a          (BatchNorm)
res5a_branch2b         (Conv2D)
bn5a_branch2b          (BatchNorm)
res5a_branch2c         (Conv2D)
res5a_branch1          (Conv2D)
bn5a_branch2c          (BatchNorm)
bn5a_branch1           (BatchNorm)
res5b_branch2a         (Conv2D)
bn5b_branch2a          (BatchNorm)
res5b_branch2b         (Conv2D)
bn5b_branch2b          (BatchNorm)
res5b_branch2c         (Conv2D)
bn5b_branch2c          (BatchNorm)
res5c_branch2a         (Conv2D)
bn5c_branch2a          (BatchNorm)
res5c_branch2b         (Conv2D)
bn5c_branch2b          (BatchNorm)
res5c_branch2c         (Conv2D)
bn5c_branch2c          (BatchNorm)
fpn_c5p5               (Conv2D)
fpn_c4p4               (Conv2D)
fpn_c3p3               (Conv2D)
fpn_c2p2               (Conv2D)
fpn_p5                 (Conv2D)
fpn_p2                 (Conv2D)
fpn_p3                 (Conv2D)
fpn_p4                 (Conv2D)
In model:  rpn_model
    rpn_conv_shared        (Conv2D)
    rpn_class_raw          (Conv2D)
    rpn_bbox_pred          (Conv2D)
mrcnn_mask_conv1       (TimeDistributed)
mrcnn_mask_bn1         (TimeDistributed)
mrcnn_mask_conv2       (TimeDistributed)
mrcnn_mask_bn2         (TimeDistributed)
mrcnn_class_conv1      (TimeDistributed)
mrcnn_class_bn1        (TimeDistributed)
mrcnn_mask_conv3       (TimeDistributed)
mrcnn_mask_bn3         (TimeDistributed)
mrcnn_class_conv2      (TimeDistributed)
mrcnn_class_bn2        (TimeDistributed)
mrcnn_mask_conv4       (TimeDistributed)
mrcnn_mask_bn4         (TimeDistributed)
mrcnn_bbox_fc          (TimeDistributed)
mrcnn_mask_deconv      (TimeDistributed)
mrcnn_class_logits     (TimeDistributed)
mrcnn_mask             (TimeDistributed)
WARNING:tensorflow:From /home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py:2162: calling reduce_mean (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/tensorflow/python/ops/gradients_impl.py:112: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/keras/engine/training.py:2087: UserWarning: Using a generator with `use_multiprocessing=True` and multiple workers may duplicate your data. Please consider using the`keras.utils.Sequence class.
  UserWarning('Using a generator with `use_multiprocessing=True`'
Epoch 1/80
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
 89/985 [=>............................] - ETA: 17:30 - loss: 1.8467 - rpn_class_loss: 0.1741 - rpn_bbox_loss: 1.0922 - mrcnn_class_loss: 0.0308 - mrcnn_bbox_loss: 0.3123 - mrcnn_mask_loss: 0.2372
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
381/985 [==========>...................] - ETA: 7:51 - loss: 1.5616 - rpn_class_loss: 0.0674 - rpn_bbox_loss: 0.6686 - mrcnn_class_loss: 0.0273 - mrcnn_bbox_loss: 0.4136 - mrcnn_mask_loss: 0.3847
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
984/985 [============================>.] - ETA: 0s - loss: 1.5245 - rpn_class_loss: 0.0415 - rpn_bbox_loss: 0.5311 - mrcnn_class_loss: 0.0419 - mrcnn_bbox_loss: 0.4273 - mrcnn_mask_loss: 0.4826
/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/keras/engine/training.py:2348: UserWarning: Using a generator with `use_multiprocessing=True` and multiple workers may duplicate your data. Please consider using the`keras.utils.Sequence class.
  UserWarning('Using a generator with `use_multiprocessing=True`'
985/985 [==============================] - 801s 813ms/step - loss: 1.5245 - rpn_class_loss: 0.0415 - rpn_bbox_loss: 0.5310 - mrcnn_class_loss: 0.0419 - mrcnn_bbox_loss: 0.4272 - mrcnn_mask_loss: 0.4829 - val_loss: 1.5260 - val_rpn_class_loss: 0.0243 - val_rpn_bbox_loss: 0.4639 - val_mrcnn_class_loss: 0.0548 - val_mrcnn_bbox_loss: 0.4006 - val_mrcnn_mask_loss: 0.5825
Epoch 2/80
225/985 [=====>........................] - ETA: 8:25 - loss: 1.5023 - rpn_class_loss: 0.0197 - rpn_bbox_loss: 0.3950 - mrcnn_class_loss: 0.0651 - mrcnn_bbox_loss: 0.4091 - mrcnn_mask_loss: 0.6134
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
691/985 [====================>.........] - ETA: 3:16 - loss: 1.4565 - rpn_class_loss: 0.0186 - rpn_bbox_loss: 0.3580 - mrcnn_class_loss: 0.0634 - mrcnn_bbox_loss: 0.4037 - mrcnn_mask_loss: 0.6128
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 758s 769ms/step - loss: 1.4197 - rpn_class_loss: 0.0176 - rpn_bbox_loss: 0.3420 - mrcnn_class_loss: 0.0647 - mrcnn_bbox_loss: 0.3956 - mrcnn_mask_loss: 0.5997 - val_loss: 1.4185 - val_rpn_class_loss: 0.0137 - val_rpn_bbox_loss: 0.4106 - val_mrcnn_class_loss: 0.0676 - val_mrcnn_bbox_loss: 0.3839 - val_mrcnn_mask_loss: 0.5428
Epoch 3/80
123/985 [==>...........................] - ETA: 9:37 - loss: 1.2942 - rpn_class_loss: 0.0145 - rpn_bbox_loss: 0.3061 - mrcnn_class_loss: 0.0591 - mrcnn_bbox_loss: 0.3615 - mrcnn_mask_loss: 0.5530
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 751s 763ms/step - loss: 1.2542 - rpn_class_loss: 0.0130 - rpn_bbox_loss: 0.2897 - mrcnn_class_loss: 0.0687 - mrcnn_bbox_loss: 0.3612 - mrcnn_mask_loss: 0.5215 - val_loss: 1.3609 - val_rpn_class_loss: 0.0141 - val_rpn_bbox_loss: 0.3314 - val_mrcnn_class_loss: 0.0881 - val_mrcnn_bbox_loss: 0.3589 - val_mrcnn_mask_loss: 0.5683
Epoch 4/80
284/985 [=======>......................] - ETA: 7:46 - loss: 1.1647 - rpn_class_loss: 0.0118 - rpn_bbox_loss: 0.2415 - mrcnn_class_loss: 0.0789 - mrcnn_bbox_loss: 0.3336 - mrcnn_mask_loss: 0.4989
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 753s 764ms/step - loss: 1.1472 - rpn_class_loss: 0.0104 - rpn_bbox_loss: 0.2481 - mrcnn_class_loss: 0.0809 - mrcnn_bbox_loss: 0.3208 - mrcnn_mask_loss: 0.4870 - val_loss: 1.1920 - val_rpn_class_loss: 0.0082 - val_rpn_bbox_loss: 0.2995 - val_mrcnn_class_loss: 0.0945 - val_mrcnn_bbox_loss: 0.3347 - val_mrcnn_mask_loss: 0.4552
Epoch 5/80
951/985 [===========================>..] - ETA: 22s - loss: 1.0903 - rpn_class_loss: 0.0085 - rpn_bbox_loss: 0.2305 - mrcnn_class_loss: 0.0784 - mrcnn_bbox_loss: 0.3065 - mrcnn_mask_loss: 0.4665
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 753s 764ms/step - loss: 1.0873 - rpn_class_loss: 0.0085 - rpn_bbox_loss: 0.2301 - mrcnn_class_loss: 0.0782 - mrcnn_bbox_loss: 0.3056 - mrcnn_mask_loss: 0.4649 - val_loss: 1.2703 - val_rpn_class_loss: 0.0072 - val_rpn_bbox_loss: 0.3423 - val_mrcnn_class_loss: 0.0785 - val_mrcnn_bbox_loss: 0.3563 - val_mrcnn_mask_loss: 0.4859
Epoch 6/80
288/985 [=======>......................] - ETA: 7:42 - loss: 0.9930 - rpn_class_loss: 0.0071 - rpn_bbox_loss: 0.2015 - mrcnn_class_loss: 0.0759 - mrcnn_bbox_loss: 0.2740 - mrcnn_mask_loss: 0.4345
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 755s 767ms/step - loss: 1.0374 - rpn_class_loss: 0.0080 - rpn_bbox_loss: 0.2167 - mrcnn_class_loss: 0.0758 - mrcnn_bbox_loss: 0.2895 - mrcnn_mask_loss: 0.4474 - val_loss: 1.2045 - val_rpn_class_loss: 0.0082 - val_rpn_bbox_loss: 0.3076 - val_mrcnn_class_loss: 0.0802 - val_mrcnn_bbox_loss: 0.3439 - val_mrcnn_mask_loss: 0.4645
Epoch 7/80
985/985 [==============================] - 748s 759ms/step - loss: 0.9939 - rpn_class_loss: 0.0077 - rpn_bbox_loss: 0.1923 - mrcnn_class_loss: 0.0749 - mrcnn_bbox_loss: 0.2820 - mrcnn_mask_loss: 0.4371 - val_loss: 1.2546 - val_rpn_class_loss: 0.0073 - val_rpn_bbox_loss: 0.3547 - val_mrcnn_class_loss: 0.0866 - val_mrcnn_bbox_loss: 0.3593 - val_mrcnn_mask_loss: 0.4467
Epoch 8/80
985/985 [==============================] - 754s 766ms/step - loss: 0.9211 - rpn_class_loss: 0.0071 - rpn_bbox_loss: 0.1680 - mrcnn_class_loss: 0.0717 - mrcnn_bbox_loss: 0.2479 - mrcnn_mask_loss: 0.4264 - val_loss: 1.3023 - val_rpn_class_loss: 0.0078 - val_rpn_bbox_loss: 0.4317 - val_mrcnn_class_loss: 0.0701 - val_mrcnn_bbox_loss: 0.3480 - val_mrcnn_mask_loss: 0.4446
Epoch 9/80
985/985 [==============================] - 756s 767ms/step - loss: 0.8916 - rpn_class_loss: 0.0067 - rpn_bbox_loss: 0.1507 - mrcnn_class_loss: 0.0711 - mrcnn_bbox_loss: 0.2469 - mrcnn_mask_loss: 0.4161 - val_loss: 1.1794 - val_rpn_class_loss: 0.0067 - val_rpn_bbox_loss: 0.3010 - val_mrcnn_class_loss: 0.0685 - val_mrcnn_bbox_loss: 0.3421 - val_mrcnn_mask_loss: 0.4610
Epoch 10/80
985/985 [==============================] - 750s 762ms/step - loss: 0.8210 - rpn_class_loss: 0.0059 - rpn_bbox_loss: 0.1248 - mrcnn_class_loss: 0.0688 - mrcnn_bbox_loss: 0.2180 - mrcnn_mask_loss: 0.4035 - val_loss: 1.1755 - val_rpn_class_loss: 0.0064 - val_rpn_bbox_loss: 0.3395 - val_mrcnn_class_loss: 0.0775 - val_mrcnn_bbox_loss: 0.3190 - val_mrcnn_mask_loss: 0.4332
Epoch 11/80
786/985 [======================>.......] - ETA: 2:11 - loss: 0.8003 - rpn_class_loss: 0.0060 - rpn_bbox_loss: 0.1211 - mrcnn_class_loss: 0.0642 - mrcnn_bbox_loss: 0.1997 - mrcnn_mask_loss: 0.4092
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 746s 757ms/step - loss: 0.7883 - rpn_class_loss: 0.0059 - rpn_bbox_loss: 0.1182 - mrcnn_class_loss: 0.0635 - mrcnn_bbox_loss: 0.1974 - mrcnn_mask_loss: 0.4033 - val_loss: 1.2166 - val_rpn_class_loss: 0.0067 - val_rpn_bbox_loss: 0.3248 - val_mrcnn_class_loss: 0.0783 - val_mrcnn_bbox_loss: 0.3572 - val_mrcnn_mask_loss: 0.4496
Epoch 12/80
708/985 [====================>.........] - ETA: 3:02 - loss: 0.7502 - rpn_class_loss: 0.0058 - rpn_bbox_loss: 0.1145 - mrcnn_class_loss: 0.0615 - mrcnn_bbox_loss: 0.1827 - mrcnn_mask_loss: 0.3858
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 749s 761ms/step - loss: 0.7504 - rpn_class_loss: 0.0055 - rpn_bbox_loss: 0.1098 - mrcnn_class_loss: 0.0622 - mrcnn_bbox_loss: 0.1847 - mrcnn_mask_loss: 0.3883 - val_loss: 1.2106 - val_rpn_class_loss: 0.0068 - val_rpn_bbox_loss: 0.3821 - val_mrcnn_class_loss: 0.0711 - val_mrcnn_bbox_loss: 0.3252 - val_mrcnn_mask_loss: 0.4255
Epoch 13/80
203/985 [=====>........................] - ETA: 8:34 - loss: 0.6981 - rpn_class_loss: 0.0053 - rpn_bbox_loss: 0.1021 - mrcnn_class_loss: 0.0637 - mrcnn_bbox_loss: 0.1698 - mrcnn_mask_loss: 0.3572
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
511/985 [==============>...............] - ETA: 5:12 - loss: 0.6955 - rpn_class_loss: 0.0052 - rpn_bbox_loss: 0.0957 - mrcnn_class_loss: 0.0605 - mrcnn_bbox_loss: 0.1672 - mrcnn_mask_loss: 0.3668
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 750s 761ms/step - loss: 0.6943 - rpn_class_loss: 0.0052 - rpn_bbox_loss: 0.0946 - mrcnn_class_loss: 0.0567 - mrcnn_bbox_loss: 0.1680 - mrcnn_mask_loss: 0.3697 - val_loss: 1.2618 - val_rpn_class_loss: 0.0067 - val_rpn_bbox_loss: 0.3559 - val_mrcnn_class_loss: 0.0794 - val_mrcnn_bbox_loss: 0.3537 - val_mrcnn_mask_loss: 0.4660
Epoch 14/80
  8/985 [..............................] - ETA: 10:46 - loss: 0.7016 - rpn_class_loss: 0.0054 - rpn_bbox_loss: 0.0863 - mrcnn_class_loss: 0.0609 - mrcnn_bbox_loss: 0.1368 - mrcnn_mask_loss: 0.4123
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
180/985 [====>.........................] - ETA: 8:53 - loss: 0.6173 - rpn_class_loss: 0.0049 - rpn_bbox_loss: 0.0844 - mrcnn_class_loss: 0.0501 - mrcnn_bbox_loss: 0.1402 - mrcnn_mask_loss: 0.3378
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
299/985 [========>.....................] - ETA: 7:35 - loss: 0.6354 - rpn_class_loss: 0.0052 - rpn_bbox_loss: 0.0867 - mrcnn_class_loss: 0.0522 - mrcnn_bbox_loss: 0.1440 - mrcnn_mask_loss: 0.3473
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 748s 759ms/step - loss: 0.6538 - rpn_class_loss: 0.0052 - rpn_bbox_loss: 0.0859 - mrcnn_class_loss: 0.0551 - mrcnn_bbox_loss: 0.1532 - mrcnn_mask_loss: 0.3543 - val_loss: 1.1755 - val_rpn_class_loss: 0.0058 - val_rpn_bbox_loss: 0.3437 - val_mrcnn_class_loss: 0.0764 - val_mrcnn_bbox_loss: 0.3149 - val_mrcnn_mask_loss: 0.4346
Epoch 15/80
985/985 [==============================] - 742s 754ms/step - loss: 0.6310 - rpn_class_loss: 0.0046 - rpn_bbox_loss: 0.0807 - mrcnn_class_loss: 0.0535 - mrcnn_bbox_loss: 0.1409 - mrcnn_mask_loss: 0.3512 - val_loss: 1.1924 - val_rpn_class_loss: 0.0060 - val_rpn_bbox_loss: 0.3383 - val_mrcnn_class_loss: 0.0693 - val_mrcnn_bbox_loss: 0.3309 - val_mrcnn_mask_loss: 0.4479
Epoch 16/80
472/985 [=============>................] - ETA: 5:39 - loss: 0.6137 - rpn_class_loss: 0.0044 - rpn_bbox_loss: 0.0734 - mrcnn_class_loss: 0.0553 - mrcnn_bbox_loss: 0.1413 - mrcnn_mask_loss: 0.3392
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 747s 758ms/step - loss: 0.5978 - rpn_class_loss: 0.0047 - rpn_bbox_loss: 0.0735 - mrcnn_class_loss: 0.0525 - mrcnn_bbox_loss: 0.1344 - mrcnn_mask_loss: 0.3328 - val_loss: 1.2195 - val_rpn_class_loss: 0.0056 - val_rpn_bbox_loss: 0.3264 - val_mrcnn_class_loss: 0.0789 - val_mrcnn_bbox_loss: 0.3166 - val_mrcnn_mask_loss: 0.4920
Epoch 17/80
687/985 [===================>..........] - ETA: 3:15 - loss: 0.5608 - rpn_class_loss: 0.0044 - rpn_bbox_loss: 0.0675 - mrcnn_class_loss: 0.0491 - mrcnn_bbox_loss: 0.1275 - mrcnn_mask_loss: 0.3122
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 740s 751ms/step - loss: 0.5527 - rpn_class_loss: 0.0041 - rpn_bbox_loss: 0.0645 - mrcnn_class_loss: 0.0501 - mrcnn_bbox_loss: 0.1227 - mrcnn_mask_loss: 0.3113 - val_loss: 1.2505 - val_rpn_class_loss: 0.0070 - val_rpn_bbox_loss: 0.3994 - val_mrcnn_class_loss: 0.0661 - val_mrcnn_bbox_loss: 0.3355 - val_mrcnn_mask_loss: 0.4424
Epoch 18/80
866/985 [=========================>....] - ETA: 1:18 - loss: 0.5343 - rpn_class_loss: 0.0045 - rpn_bbox_loss: 0.0635 - mrcnn_class_loss: 0.0506 - mrcnn_bbox_loss: 0.1181 - mrcnn_mask_loss: 0.2976
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 741s 753ms/step - loss: 0.5233 - rpn_class_loss: 0.0043 - rpn_bbox_loss: 0.0613 - mrcnn_class_loss: 0.0493 - mrcnn_bbox_loss: 0.1155 - mrcnn_mask_loss: 0.2929 - val_loss: 1.3526 - val_rpn_class_loss: 0.0064 - val_rpn_bbox_loss: 0.3833 - val_mrcnn_class_loss: 0.0754 - val_mrcnn_bbox_loss: 0.3412 - val_mrcnn_mask_loss: 0.5463
Epoch 19/80
822/985 [========================>.....] - ETA: 1:46 - loss: 0.5043 - rpn_class_loss: 0.0038 - rpn_bbox_loss: 0.0562 - mrcnn_class_loss: 0.0433 - mrcnn_bbox_loss: 0.1049 - mrcnn_mask_loss: 0.2960
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 740s 751ms/step - loss: 0.4959 - rpn_class_loss: 0.0037 - rpn_bbox_loss: 0.0556 - mrcnn_class_loss: 0.0425 - mrcnn_bbox_loss: 0.1031 - mrcnn_mask_loss: 0.2910 - val_loss: 1.3093 - val_rpn_class_loss: 0.0055 - val_rpn_bbox_loss: 0.3123 - val_mrcnn_class_loss: 0.0709 - val_mrcnn_bbox_loss: 0.3254 - val_mrcnn_mask_loss: 0.5950
Epoch 20/80
985/985 [==============================] - 740s 751ms/step - loss: 0.4632 - rpn_class_loss: 0.0039 - rpn_bbox_loss: 0.0554 - mrcnn_class_loss: 0.0417 - mrcnn_bbox_loss: 0.0966 - mrcnn_mask_loss: 0.2656 - val_loss: 1.3967 - val_rpn_class_loss: 0.0069 - val_rpn_bbox_loss: 0.4076 - val_mrcnn_class_loss: 0.0758 - val_mrcnn_bbox_loss: 0.3608 - val_mrcnn_mask_loss: 0.5456
Epoch 21/80
140/985 [===>..........................] - ETA: 9:15 - loss: 0.4350 - rpn_class_loss: 0.0038 - rpn_bbox_loss: 0.0531 - mrcnn_class_loss: 0.0403 - mrcnn_bbox_loss: 0.0922 - mrcnn_mask_loss: 0.2456
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 741s 753ms/step - loss: 0.4339 - rpn_class_loss: 0.0036 - rpn_bbox_loss: 0.0531 - mrcnn_class_loss: 0.0396 - mrcnn_bbox_loss: 0.0907 - mrcnn_mask_loss: 0.2468 - val_loss: 1.3427 - val_rpn_class_loss: 0.0065 - val_rpn_bbox_loss: 0.3393 - val_mrcnn_class_loss: 0.0859 - val_mrcnn_bbox_loss: 0.3511 - val_mrcnn_mask_loss: 0.5600
Epoch 22/80
846/985 [========================>.....] - ETA: 1:31 - loss: 0.4097 - rpn_class_loss: 0.0031 - rpn_bbox_loss: 0.0488 - mrcnn_class_loss: 0.0377 - mrcnn_bbox_loss: 0.0865 - mrcnn_mask_loss: 0.2337
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 738s 749ms/step - loss: 0.4128 - rpn_class_loss: 0.0031 - rpn_bbox_loss: 0.0493 - mrcnn_class_loss: 0.0377 - mrcnn_bbox_loss: 0.0868 - mrcnn_mask_loss: 0.2359 - val_loss: 1.4174 - val_rpn_class_loss: 0.0067 - val_rpn_bbox_loss: 0.3398 - val_mrcnn_class_loss: 0.0877 - val_mrcnn_bbox_loss: 0.3499 - val_mrcnn_mask_loss: 0.6334
Epoch 23/80
 37/985 [>.............................] - ETA: 10:14 - loss: 0.4116 - rpn_class_loss: 0.0038 - rpn_bbox_loss: 0.0495 - mrcnn_class_loss: 0.0409 - mrcnn_bbox_loss: 0.0957 - mrcnn_mask_loss: 0.2218
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
 72/985 [=>............................] - ETA: 9:49 - loss: 0.3925 - rpn_class_loss: 0.0033 - rpn_bbox_loss: 0.0449 - mrcnn_class_loss: 0.0372 - mrcnn_bbox_loss: 0.0920 - mrcnn_mask_loss: 0.2150
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
292/985 [=======>......................] - ETA: 7:33 - loss: 0.4001 - rpn_class_loss: 0.0033 - rpn_bbox_loss: 0.0477 - mrcnn_class_loss: 0.0360 - mrcnn_bbox_loss: 0.0824 - mrcnn_mask_loss: 0.2306
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
955/985 [============================>.] - ETA: 19s - loss: 0.3871 - rpn_class_loss: 0.0030 - rpn_bbox_loss: 0.0454 - mrcnn_class_loss: 0.0361 - mrcnn_bbox_loss: 0.0799 - mrcnn_mask_loss: 0.2227
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
967/985 [============================>.] - ETA: 11s - loss: 0.3862 - rpn_class_loss: 0.0030 - rpn_bbox_loss: 0.0454 - mrcnn_class_loss: 0.0360 - mrcnn_bbox_loss: 0.0796 - mrcnn_mask_loss: 0.2222
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 742s 753ms/step - loss: 0.3845 - rpn_class_loss: 0.0030 - rpn_bbox_loss: 0.0454 - mrcnn_class_loss: 0.0359 - mrcnn_bbox_loss: 0.0794 - mrcnn_mask_loss: 0.2209 - val_loss: 1.3468 - val_rpn_class_loss: 0.0060 - val_rpn_bbox_loss: 0.3535 - val_mrcnn_class_loss: 0.0882 - val_mrcnn_bbox_loss: 0.3402 - val_mrcnn_mask_loss: 0.5589
Epoch 24/80
732/985 [=====================>........] - ETA: 2:45 - loss: 0.3870 - rpn_class_loss: 0.0031 - rpn_bbox_loss: 0.0439 - mrcnn_class_loss: 0.0368 - mrcnn_bbox_loss: 0.0790 - mrcnn_mask_loss: 0.2243
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 742s 753ms/step - loss: 0.3755 - rpn_class_loss: 0.0029 - rpn_bbox_loss: 0.0434 - mrcnn_class_loss: 0.0349 - mrcnn_bbox_loss: 0.0757 - mrcnn_mask_loss: 0.2186 - val_loss: 1.4295 - val_rpn_class_loss: 0.0068 - val_rpn_bbox_loss: 0.4079 - val_mrcnn_class_loss: 0.0732 - val_mrcnn_bbox_loss: 0.3198 - val_mrcnn_mask_loss: 0.6218
Epoch 25/80
 82/985 [=>............................] - ETA: 9:46 - loss: 0.3473 - rpn_class_loss: 0.0025 - rpn_bbox_loss: 0.0409 - mrcnn_class_loss: 0.0365 - mrcnn_bbox_loss: 0.0720 - mrcnn_mask_loss: 0.1954
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 740s 751ms/step - loss: 0.3540 - rpn_class_loss: 0.0027 - rpn_bbox_loss: 0.0429 - mrcnn_class_loss: 0.0323 - mrcnn_bbox_loss: 0.0737 - mrcnn_mask_loss: 0.2024 - val_loss: 1.4574 - val_rpn_class_loss: 0.0063 - val_rpn_bbox_loss: 0.3308 - val_mrcnn_class_loss: 0.0772 - val_mrcnn_bbox_loss: 0.3370 - val_mrcnn_mask_loss: 0.7061
Epoch 26/80
985/985 [==============================] - 733s 744ms/step - loss: 0.3445 - rpn_class_loss: 0.0026 - rpn_bbox_loss: 0.0411 - mrcnn_class_loss: 0.0299 - mrcnn_bbox_loss: 0.0685 - mrcnn_mask_loss: 0.2024 - val_loss: 1.5417 - val_rpn_class_loss: 0.0081 - val_rpn_bbox_loss: 0.3513 - val_mrcnn_class_loss: 0.0987 - val_mrcnn_bbox_loss: 0.3608 - val_mrcnn_mask_loss: 0.7227
Epoch 27/80
298/985 [========>.....................] - ETA: 7:27 - loss: 0.3370 - rpn_class_loss: 0.0025 - rpn_bbox_loss: 0.0397 - mrcnn_class_loss: 0.0293 - mrcnn_bbox_loss: 0.0679 - mrcnn_mask_loss: 0.1976
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
732/985 [=====================>........] - ETA: 2:44 - loss: 0.3300 - rpn_class_loss: 0.0025 - rpn_bbox_loss: 0.0388 - mrcnn_class_loss: 0.0289 - mrcnn_bbox_loss: 0.0647 - mrcnn_mask_loss: 0.1950
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 742s 753ms/step - loss: 0.3214 - rpn_class_loss: 0.0024 - rpn_bbox_loss: 0.0377 - mrcnn_class_loss: 0.0280 - mrcnn_bbox_loss: 0.0643 - mrcnn_mask_loss: 0.1890 - val_loss: 1.3564 - val_rpn_class_loss: 0.0065 - val_rpn_bbox_loss: 0.3786 - val_mrcnn_class_loss: 0.0846 - val_mrcnn_bbox_loss: 0.3058 - val_mrcnn_mask_loss: 0.5808
Epoch 28/80
985/985 [==============================] - 737s 748ms/step - loss: 0.3223 - rpn_class_loss: 0.0022 - rpn_bbox_loss: 0.0382 - mrcnn_class_loss: 0.0259 - mrcnn_bbox_loss: 0.0620 - mrcnn_mask_loss: 0.1939 - val_loss: 1.4308 - val_rpn_class_loss: 0.0074 - val_rpn_bbox_loss: 0.3220 - val_mrcnn_class_loss: 0.0954 - val_mrcnn_bbox_loss: 0.3449 - val_mrcnn_mask_loss: 0.6611
Epoch 29/80
985/985 [==============================] - 741s 752ms/step - loss: 0.3114 - rpn_class_loss: 0.0025 - rpn_bbox_loss: 0.0379 - mrcnn_class_loss: 0.0237 - mrcnn_bbox_loss: 0.0605 - mrcnn_mask_loss: 0.1868 - val_loss: 1.5537 - val_rpn_class_loss: 0.0070 - val_rpn_bbox_loss: 0.3453 - val_mrcnn_class_loss: 0.1018 - val_mrcnn_bbox_loss: 0.3459 - val_mrcnn_mask_loss: 0.7538
Epoch 30/80
121/985 [==>...........................] - ETA: 9:26 - loss: 0.3393 - rpn_class_loss: 0.0027 - rpn_bbox_loss: 0.0358 - mrcnn_class_loss: 0.0288 - mrcnn_bbox_loss: 0.0725 - mrcnn_mask_loss: 0.1996
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
675/985 [===================>..........] - ETA: 3:23 - loss: 0.2996 - rpn_class_loss: 0.0023 - rpn_bbox_loss: 0.0350 - mrcnn_class_loss: 0.0236 - mrcnn_bbox_loss: 0.0595 - mrcnn_mask_loss: 0.1792
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 742s 753ms/step - loss: 0.2993 - rpn_class_loss: 0.0021 - rpn_bbox_loss: 0.0358 - mrcnn_class_loss: 0.0230 - mrcnn_bbox_loss: 0.0591 - mrcnn_mask_loss: 0.1793 - val_loss: 1.5314 - val_rpn_class_loss: 0.0085 - val_rpn_bbox_loss: 0.3466 - val_mrcnn_class_loss: 0.1138 - val_mrcnn_bbox_loss: 0.3282 - val_mrcnn_mask_loss: 0.7343
Epoch 31/80
155/985 [===>..........................] - ETA: 9:03 - loss: 0.2669 - rpn_class_loss: 0.0020 - rpn_bbox_loss: 0.0338 - mrcnn_class_loss: 0.0249 - mrcnn_bbox_loss: 0.0546 - mrcnn_mask_loss: 0.1515
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 739s 751ms/step - loss: 0.2796 - rpn_class_loss: 0.0020 - rpn_bbox_loss: 0.0357 - mrcnn_class_loss: 0.0223 - mrcnn_bbox_loss: 0.0548 - mrcnn_mask_loss: 0.1647 - val_loss: 1.4071 - val_rpn_class_loss: 0.0066 - val_rpn_bbox_loss: 0.3596 - val_mrcnn_class_loss: 0.0973 - val_mrcnn_bbox_loss: 0.3008 - val_mrcnn_mask_loss: 0.6428
Epoch 32/80
985/985 [==============================] - 738s 749ms/step - loss: 0.2713 - rpn_class_loss: 0.0019 - rpn_bbox_loss: 0.0343 - mrcnn_class_loss: 0.0201 - mrcnn_bbox_loss: 0.0498 - mrcnn_mask_loss: 0.1652 - val_loss: 1.5453 - val_rpn_class_loss: 0.0057 - val_rpn_bbox_loss: 0.3383 - val_mrcnn_class_loss: 0.1082 - val_mrcnn_bbox_loss: 0.3395 - val_mrcnn_mask_loss: 0.7537
Epoch 33/80
677/985 [===================>..........] - ETA: 3:20 - loss: 0.2738 - rpn_class_loss: 0.0022 - rpn_bbox_loss: 0.0340 - mrcnn_class_loss: 0.0196 - mrcnn_bbox_loss: 0.0515 - mrcnn_mask_loss: 0.1665
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
720/985 [====================>.........] - ETA: 2:52 - loss: 0.2719 - rpn_class_loss: 0.0022 - rpn_bbox_loss: 0.0335 - mrcnn_class_loss: 0.0195 - mrcnn_bbox_loss: 0.0511 - mrcnn_mask_loss: 0.1656
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 739s 750ms/step - loss: 0.2666 - rpn_class_loss: 0.0021 - rpn_bbox_loss: 0.0322 - mrcnn_class_loss: 0.0193 - mrcnn_bbox_loss: 0.0496 - mrcnn_mask_loss: 0.1634 - val_loss: 1.4897 - val_rpn_class_loss: 0.0063 - val_rpn_bbox_loss: 0.4083 - val_mrcnn_class_loss: 0.1038 - val_mrcnn_bbox_loss: 0.2678 - val_mrcnn_mask_loss: 0.7035
Epoch 34/80
399/985 [===========>..................] - ETA: 6:22 - loss: 0.2700 - rpn_class_loss: 0.0019 - rpn_bbox_loss: 0.0298 - mrcnn_class_loss: 0.0177 - mrcnn_bbox_loss: 0.0504 - mrcnn_mask_loss: 0.1702
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 739s 750ms/step - loss: 0.2624 - rpn_class_loss: 0.0019 - rpn_bbox_loss: 0.0311 - mrcnn_class_loss: 0.0180 - mrcnn_bbox_loss: 0.0487 - mrcnn_mask_loss: 0.1627 - val_loss: 1.4528 - val_rpn_class_loss: 0.0067 - val_rpn_bbox_loss: 0.4057 - val_mrcnn_class_loss: 0.0856 - val_mrcnn_bbox_loss: 0.3174 - val_mrcnn_mask_loss: 0.6374
Epoch 35/80
885/985 [=========================>....] - ETA: 1:05 - loss: 0.2553 - rpn_class_loss: 0.0018 - rpn_bbox_loss: 0.0318 - mrcnn_class_loss: 0.0152 - mrcnn_bbox_loss: 0.0471 - mrcnn_mask_loss: 0.1593
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 735s 746ms/step - loss: 0.2549 - rpn_class_loss: 0.0018 - rpn_bbox_loss: 0.0317 - mrcnn_class_loss: 0.0150 - mrcnn_bbox_loss: 0.0471 - mrcnn_mask_loss: 0.1592 - val_loss: 1.5435 - val_rpn_class_loss: 0.0071 - val_rpn_bbox_loss: 0.3871 - val_mrcnn_class_loss: 0.0934 - val_mrcnn_bbox_loss: 0.3329 - val_mrcnn_mask_loss: 0.7230
Epoch 36/80
985/985 [==============================] - 738s 749ms/step - loss: 0.2358 - rpn_class_loss: 0.0017 - rpn_bbox_loss: 0.0302 - mrcnn_class_loss: 0.0150 - mrcnn_bbox_loss: 0.0457 - mrcnn_mask_loss: 0.1433 - val_loss: 1.8335 - val_rpn_class_loss: 0.0080 - val_rpn_bbox_loss: 0.3886 - val_mrcnn_class_loss: 0.1100 - val_mrcnn_bbox_loss: 0.3454 - val_mrcnn_mask_loss: 0.9814
Epoch 37/80
985/985 [==============================] - 735s 747ms/step - loss: 0.2296 - rpn_class_loss: 0.0016 - rpn_bbox_loss: 0.0294 - mrcnn_class_loss: 0.0143 - mrcnn_bbox_loss: 0.0424 - mrcnn_mask_loss: 0.1419 - val_loss: 1.6708 - val_rpn_class_loss: 0.0085 - val_rpn_bbox_loss: 0.4560 - val_mrcnn_class_loss: 0.1245 - val_mrcnn_bbox_loss: 0.3034 - val_mrcnn_mask_loss: 0.7783
Epoch 38/80
843/985 [========================>.....] - ETA: 1:32 - loss: 0.2302 - rpn_class_loss: 0.0016 - rpn_bbox_loss: 0.0282 - mrcnn_class_loss: 0.0127 - mrcnn_bbox_loss: 0.0417 - mrcnn_mask_loss: 0.1460
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 741s 752ms/step - loss: 0.2302 - rpn_class_loss: 0.0015 - rpn_bbox_loss: 0.0282 - mrcnn_class_loss: 0.0126 - mrcnn_bbox_loss: 0.0416 - mrcnn_mask_loss: 0.1463 - val_loss: 1.6188 - val_rpn_class_loss: 0.0086 - val_rpn_bbox_loss: 0.4174 - val_mrcnn_class_loss: 0.0921 - val_mrcnn_bbox_loss: 0.3335 - val_mrcnn_mask_loss: 0.7672
Epoch 39/80
985/985 [==============================] - 740s 751ms/step - loss: 0.2250 - rpn_class_loss: 0.0015 - rpn_bbox_loss: 0.0280 - mrcnn_class_loss: 0.0129 - mrcnn_bbox_loss: 0.0402 - mrcnn_mask_loss: 0.1424 - val_loss: 1.5246 - val_rpn_class_loss: 0.0073 - val_rpn_bbox_loss: 0.4129 - val_mrcnn_class_loss: 0.0952 - val_mrcnn_bbox_loss: 0.3362 - val_mrcnn_mask_loss: 0.6731
Epoch 40/80
215/985 [=====>........................] - ETA: 8:26 - loss: 0.2136 - rpn_class_loss: 0.0013 - rpn_bbox_loss: 0.0225 - mrcnn_class_loss: 0.0101 - mrcnn_bbox_loss: 0.0358 - mrcnn_mask_loss: 0.1440
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 744s 755ms/step - loss: 0.2130 - rpn_class_loss: 0.0014 - rpn_bbox_loss: 0.0256 - mrcnn_class_loss: 0.0103 - mrcnn_bbox_loss: 0.0378 - mrcnn_mask_loss: 0.1379 - val_loss: 1.4591 - val_rpn_class_loss: 0.0080 - val_rpn_bbox_loss: 0.3683 - val_mrcnn_class_loss: 0.1117 - val_mrcnn_bbox_loss: 0.3086 - val_mrcnn_mask_loss: 0.6625
Epoch 41/80
302/985 [========>.....................] - ETA: 7:25 - loss: 0.2130 - rpn_class_loss: 0.0013 - rpn_bbox_loss: 0.0268 - mrcnn_class_loss: 0.0127 - mrcnn_bbox_loss: 0.0404 - mrcnn_mask_loss: 0.1317
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 739s 751ms/step - loss: 0.2100 - rpn_class_loss: 0.0014 - rpn_bbox_loss: 0.0268 - mrcnn_class_loss: 0.0112 - mrcnn_bbox_loss: 0.0385 - mrcnn_mask_loss: 0.1321 - val_loss: 1.7440 - val_rpn_class_loss: 0.0100 - val_rpn_bbox_loss: 0.3717 - val_mrcnn_class_loss: 0.1365 - val_mrcnn_bbox_loss: 0.3871 - val_mrcnn_mask_loss: 0.8386
Epoch 42/80
715/985 [====================>.........] - ETA: 2:57 - loss: 0.2060 - rpn_class_loss: 0.0013 - rpn_bbox_loss: 0.0264 - mrcnn_class_loss: 0.0086 - mrcnn_bbox_loss: 0.0356 - mrcnn_mask_loss: 0.1342
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 740s 751ms/step - loss: 0.2039 - rpn_class_loss: 0.0013 - rpn_bbox_loss: 0.0255 - mrcnn_class_loss: 0.0086 - mrcnn_bbox_loss: 0.0356 - mrcnn_mask_loss: 0.1330 - val_loss: 1.6634 - val_rpn_class_loss: 0.0083 - val_rpn_bbox_loss: 0.3563 - val_mrcnn_class_loss: 0.1323 - val_mrcnn_bbox_loss: 0.3165 - val_mrcnn_mask_loss: 0.8500
Epoch 43/80
985/985 [==============================] - 738s 749ms/step - loss: 0.1995 - rpn_class_loss: 0.0012 - rpn_bbox_loss: 0.0236 - mrcnn_class_loss: 0.0092 - mrcnn_bbox_loss: 0.0341 - mrcnn_mask_loss: 0.1314 - val_loss: 1.7077 - val_rpn_class_loss: 0.0092 - val_rpn_bbox_loss: 0.4236 - val_mrcnn_class_loss: 0.1086 - val_mrcnn_bbox_loss: 0.3126 - val_mrcnn_mask_loss: 0.8538
Epoch 44/80
139/985 [===>..........................] - ETA: 9:15 - loss: 0.1957 - rpn_class_loss: 0.0014 - rpn_bbox_loss: 0.0250 - mrcnn_class_loss: 0.0109 - mrcnn_bbox_loss: 0.0357 - mrcnn_mask_loss: 0.1227
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 741s 752ms/step - loss: 0.1961 - rpn_class_loss: 0.0013 - rpn_bbox_loss: 0.0238 - mrcnn_class_loss: 0.0097 - mrcnn_bbox_loss: 0.0340 - mrcnn_mask_loss: 0.1273 - val_loss: 1.8207 - val_rpn_class_loss: 0.0098 - val_rpn_bbox_loss: 0.4048 - val_mrcnn_class_loss: 0.1385 - val_mrcnn_bbox_loss: 0.3476 - val_mrcnn_mask_loss: 0.9200
Epoch 45/80
741/985 [=====================>........] - ETA: 2:39 - loss: 0.1928 - rpn_class_loss: 0.0013 - rpn_bbox_loss: 0.0235 - mrcnn_class_loss: 0.0078 - mrcnn_bbox_loss: 0.0326 - mrcnn_mask_loss: 0.1277
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 734s 745ms/step - loss: 0.1934 - rpn_class_loss: 0.0012 - rpn_bbox_loss: 0.0233 - mrcnn_class_loss: 0.0079 - mrcnn_bbox_loss: 0.0324 - mrcnn_mask_loss: 0.1286 - val_loss: 1.7233 - val_rpn_class_loss: 0.0085 - val_rpn_bbox_loss: 0.3920 - val_mrcnn_class_loss: 0.1246 - val_mrcnn_bbox_loss: 0.3588 - val_mrcnn_mask_loss: 0.8394
Epoch 46/80
878/985 [=========================>....] - ETA: 1:09 - loss: 0.1885 - rpn_class_loss: 0.0011 - rpn_bbox_loss: 0.0243 - mrcnn_class_loss: 0.0082 - mrcnn_bbox_loss: 0.0307 - mrcnn_mask_loss: 0.1243
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 737s 748ms/step - loss: 0.1875 - rpn_class_loss: 0.0011 - rpn_bbox_loss: 0.0243 - mrcnn_class_loss: 0.0085 - mrcnn_bbox_loss: 0.0309 - mrcnn_mask_loss: 0.1227 - val_loss: 1.6328 - val_rpn_class_loss: 0.0084 - val_rpn_bbox_loss: 0.3731 - val_mrcnn_class_loss: 0.1260 - val_mrcnn_bbox_loss: 0.3183 - val_mrcnn_mask_loss: 0.8069
Epoch 47/80
985/985 [==============================] - 744s 756ms/step - loss: 0.1863 - rpn_class_loss: 0.0011 - rpn_bbox_loss: 0.0214 - mrcnn_class_loss: 0.0083 - mrcnn_bbox_loss: 0.0321 - mrcnn_mask_loss: 0.1234 - val_loss: 1.6899 - val_rpn_class_loss: 0.0086 - val_rpn_bbox_loss: 0.4068 - val_mrcnn_class_loss: 0.1133 - val_mrcnn_bbox_loss: 0.3120 - val_mrcnn_mask_loss: 0.8491
Epoch 48/80
985/985 [==============================] - 738s 749ms/step - loss: 0.1764 - rpn_class_loss: 0.0012 - rpn_bbox_loss: 0.0216 - mrcnn_class_loss: 0.0077 - mrcnn_bbox_loss: 0.0302 - mrcnn_mask_loss: 0.1156 - val_loss: 1.7000 - val_rpn_class_loss: 0.0101 - val_rpn_bbox_loss: 0.3757 - val_mrcnn_class_loss: 0.1333 - val_mrcnn_bbox_loss: 0.3429 - val_mrcnn_mask_loss: 0.8380
Epoch 49/80
985/985 [==============================] - 745s 756ms/step - loss: 0.1793 - rpn_class_loss: 0.0011 - rpn_bbox_loss: 0.0230 - mrcnn_class_loss: 0.0069 - mrcnn_bbox_loss: 0.0304 - mrcnn_mask_loss: 0.1178 - val_loss: 1.6802 - val_rpn_class_loss: 0.0078 - val_rpn_bbox_loss: 0.3878 - val_mrcnn_class_loss: 0.1617 - val_mrcnn_bbox_loss: 0.3157 - val_mrcnn_mask_loss: 0.8070
Epoch 50/80
648/985 [==================>...........] - ETA: 3:39 - loss: 0.1729 - rpn_class_loss: 0.0011 - rpn_bbox_loss: 0.0206 - mrcnn_class_loss: 0.0061 - mrcnn_bbox_loss: 0.0280 - mrcnn_mask_loss: 0.1171
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 744s 755ms/step - loss: 0.1730 - rpn_class_loss: 0.0011 - rpn_bbox_loss: 0.0211 - mrcnn_class_loss: 0.0061 - mrcnn_bbox_loss: 0.0283 - mrcnn_mask_loss: 0.1165 - val_loss: 1.6943 - val_rpn_class_loss: 0.0112 - val_rpn_bbox_loss: 0.3769 - val_mrcnn_class_loss: 0.1653 - val_mrcnn_bbox_loss: 0.3340 - val_mrcnn_mask_loss: 0.8069
Epoch 51/80
815/985 [=======================>......] - ETA: 1:51 - loss: 0.1694 - rpn_class_loss: 0.0010 - rpn_bbox_loss: 0.0209 - mrcnn_class_loss: 0.0056 - mrcnn_bbox_loss: 0.0267 - mrcnn_mask_loss: 0.1151
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 745s 757ms/step - loss: 0.1709 - rpn_class_loss: 9.7917e-04 - rpn_bbox_loss: 0.0207 - mrcnn_class_loss: 0.0055 - mrcnn_bbox_loss: 0.0270 - mrcnn_mask_loss: 0.1167 - val_loss: 1.8436 - val_rpn_class_loss: 0.0117 - val_rpn_bbox_loss: 0.4465 - val_mrcnn_class_loss: 0.1699 - val_mrcnn_bbox_loss: 0.3415 - val_mrcnn_mask_loss: 0.8739
Epoch 52/80
104/985 [==>...........................] - ETA: 9:35 - loss: 0.1673 - rpn_class_loss: 8.1667e-04 - rpn_bbox_loss: 0.0178 - mrcnn_class_loss: 0.0062 - mrcnn_bbox_loss: 0.0258 - mrcnn_mask_loss: 0.1167
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
338/985 [=========>....................] - ETA: 7:02 - loss: 0.1655 - rpn_class_loss: 8.5016e-04 - rpn_bbox_loss: 0.0196 - mrcnn_class_loss: 0.0058 - mrcnn_bbox_loss: 0.0273 - mrcnn_mask_loss: 0.1120
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
528/985 [===============>..............] - ETA: 4:58 - loss: 0.1652 - rpn_class_loss: 9.0272e-04 - rpn_bbox_loss: 0.0208 - mrcnn_class_loss: 0.0056 - mrcnn_bbox_loss: 0.0285 - mrcnn_mask_loss: 0.1094
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 738s 750ms/step - loss: 0.1659 - rpn_class_loss: 9.1892e-04 - rpn_bbox_loss: 0.0213 - mrcnn_class_loss: 0.0056 - mrcnn_bbox_loss: 0.0278 - mrcnn_mask_loss: 0.1102 - val_loss: 1.7487 - val_rpn_class_loss: 0.0076 - val_rpn_bbox_loss: 0.3828 - val_mrcnn_class_loss: 0.1242 - val_mrcnn_bbox_loss: 0.3206 - val_mrcnn_mask_loss: 0.9134
Epoch 53/80
747/985 [=====================>........] - ETA: 2:35 - loss: 0.1629 - rpn_class_loss: 0.0011 - rpn_bbox_loss: 0.0193 - mrcnn_class_loss: 0.0055 - mrcnn_bbox_loss: 0.0271 - mrcnn_mask_loss: 0.1100
ERROR:root:Error processing image {'id': 'Mass-Training_P_00076_LEFT_CC', 'source': 'pathology', 'path': '/home/liujing/liuyibo/Mammo_MaskRCNN/dataset/mammo_all/mass_train/Mass-Training_P_00076_LEFT_CC/full_image/Mass-Training_P_00076_LEFT_CC.png', 'pathology': ['BENIGN'], 'catID': [2]}
Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 224, in load
    s = read(self.decodermaxblock)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 652, in load_read
    cid, pos, length = self.png.read()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/PngImagePlugin.py", line 122, in read
    length = i32(s)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/_binary.py", line 77, in i32be
    return unpack_from(">I", c, o)[0]
struct.error: unpack_from requires a buffer of at least 4 bytes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 518, in pil_try_read
    im.getdata()[0]
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/Image.py", line 1277, in getdata
    self.load()
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/PIL/ImageFile.py", line 230, in load
    raise IOError("image file is truncated")
OSError: image file is truncated

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1704, in data_generator
    use_mini_mask=config.USE_MINI_MASK)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/model.py", line 1218, in load_image_gt
    image = dataset.load_image(image_id)
  File "/home/liujing/liuyibo/Mammo_MaskRCNN/mrcnn/utils.py", line 377, in load_image
    image = skimage.io.imread(self.image_info[image_id]['path'])
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/_io.py", line 61, in imread
    img = call_plugin('imread', fname, plugin=plugin, **plugin_args)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/skimage/io/manage_plugins.py", line 210, in call_plugin
    return func(*args, **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 221, in imread
    reader = read(uri, format, "i", **kwargs)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/functions.py", line 143, in get_reader
    return format.get_reader(request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 164, in get_reader
    return self.Reader(self, request)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/core/format.py", line 214, in __init__
    self._open(**self.request.kwargs.copy())
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 293, in _open
    return PillowFormat.Reader._open(self, pilmode=pilmode, as_gray=as_gray)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 137, in _open
    pil_try_read(self._im)
  File "/home/liujing/anaconda3/envs/keras/lib/python3.6/site-packages/imageio/plugins/pillow.py", line 529, in pil_try_read
    raise ValueError(error_message)
ValueError: Could not load "" 
Reason: "image file is truncated"
Please see documentation at: http://pillow.readthedocs.io/en/latest/installation.html#external-libraries
985/985 [==============================] - 740s 751ms/step - loss: 0.1630 - rpn_class_loss: 0.0010 - rpn_bbox_loss: 0.0188 - mrcnn_class_loss: 0.0055 - mrcnn_bbox_loss: 0.0265 - mrcnn_mask_loss: 0.1112 - val_loss: 1.7070 - val_rpn_class_loss: 0.0113 - val_rpn_bbox_loss: 0.4246 - val_mrcnn_class_loss: 0.1332 - val_mrcnn_bbox_loss: 0.3425 - val_mrcnn_mask_loss: 0.7955
Epoch 54/80
 97/985 [=>............................] - ETA: 9:36 - loss: 0.1566 - rpn_class_loss: 8.7757e-04 - rpn_bbox_loss: 0.0187 - mrcnn_class_loss: 0.0061 - mrcnn_bbox_loss: 0.0240 - mrcnn_mask_loss: 0.1069
1
#plot loss 
2
history=model.keras_model.fit(steps_per_epoch=config.STEPS_PER_EPOCH, validation_steps=config.VALIDATION_STEPS, 
3
                              batch_size=config.BATCH_SIZE)
4
# loss     rpn_class_loss     rpn_bbox_loss     mrcnn_class_loss     mrcnn_bbox_loss     mrcnn_mask_loss
5
plt.plot(history.history['loss'])
6
plt.plot(history.history['val_loss'])
7
plt.title("model loss")
8
plt.ylabel("loss")
9
plt.xlabel("epoch")
10
plt.legend(["train","test"],loc="upper left")
11
plt.show()
---------------------------------------------------------------------------
UnboundLocalError                         Traceback (most recent call last)
<ipython-input-8-ef95a194f9e9> in <module>
      1 #plot loss
      2 history=model.keras_model.fit(steps_per_epoch=config.STEPS_PER_EPOCH, validation_steps=config.VALIDATION_STEPS, 
----> 3                               batch_size=config.BATCH_SIZE)
      4 # loss     rpn_class_loss     rpn_bbox_loss     mrcnn_class_loss     mrcnn_bbox_loss     mrcnn_mask_loss
      5 plt.plot(history.history['loss'])

~/anaconda3/envs/keras/lib/python3.6/site-packages/keras/engine/training.py in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, **kwargs)
   1699                               batch_size=batch_size, epochs=epochs,
   1700                               verbose=verbose, callbacks=callbacks,
-> 1701                               val_f=val_f, val_ins=val_ins, shuffle=shuffle,
   1702                               callback_metrics=callback_metrics,
   1703                               initial_epoch=initial_epoch,

UnboundLocalError: local variable 'val_ins' referenced before assignment
